public boolean updateTransferNumber(String accNum, String newTransferNum, String active, String userId) {
    Log.info("Inside updateTransferNumber service");

    Connection connection = null;
    PreparedStatement preparedStatement = null;

    try {
        connection = dataSourceConfiguration.getDataSource().getConnection();
        String updateQuery = "UPDATE OVERRIDE_TRANSFER_NUMBER_FOR_EXCEPTION_ACCOUNT " +
                "SET TRANSFER_NUMBER = ?, IS_ACTIVE = ?, UPDATED_BY = ?, UPDATED_DATE = GETDATE() " +
                "WHERE ACCOUNT_NUMBER = ?";

        preparedStatement = connection.prepareStatement(updateQuery);
        preparedStatement.setString(1, newTransferNum);
        preparedStatement.setString(2, active);
        preparedStatement.setString(3, userId);
        preparedStatement.setString(4, accNum);

        int rowsUpdated = preparedStatement.executeUpdate();
        Log.info("Rows updated: " + rowsUpdated);
        return rowsUpdated > 0;

    } catch (Exception e) {
        Log.error("Error updating transfer number: ", e);
        return false;

    } finally {
        try {
            if (preparedStatement != null) preparedStatement.close();
            if (connection != null) connection.close();
        } catch (Exception e) {
            Log.error("Error closing resources: ", e);
        }
    }
}
