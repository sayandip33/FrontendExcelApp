fetch("upload", {
  method: "POST",
  body: formData
})
  .then(res => res.json())
  .then(msg => {
    console.log('msg : ', msg);

    const successMsg = msg.success?.[0] || '';
    const failureMsg = msg.failure?.[0] || '';
    const logFile = msg.logFile?.[0];

    // Show success message
    if (successMsg) {
      document.getElementById("response").innerText = successMsg;
      document.getElementById("response").style.color = "green";
    }

    // Show failure message
    if (failureMsg) {
      document.getElementById("errorResponse").innerText = failureMsg;
      document.getElementById("errorResponse").style.color = "red";
    }

    // Auto-download log file if available
    if (logFile) {
      const a = document.createElement("a");
      a.href = `/downloadLog?fileName=${encodeURIComponent(logFile)}`;
      a.download = logFile;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
    }
  })
  .catch(err => {
    console.error("Upload failed:", err);
    alert("Something went wrong during upload. Please try again.");
  });
